"use strict";(()=>{var e={};e.id=718,e.ids=[718],e.modules={30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},46217:(e,t,r)=>{r.r(t),r.d(t,{headerHooks:()=>h,originalPathname:()=>m,patchFetch:()=>f,requestAsyncStorage:()=>l,routeModule:()=>u,serverHooks:()=>p,staticGenerationAsyncStorage:()=>d,staticGenerationBailout:()=>g});var o={};r.r(o),r.d(o,{POST:()=>c});var a=r(95419),n=r(69108),i=r(99678),s=r(78070);async function c(e){try{let{code:t}=await e.json();if(!t)return s.Z.json({error:"Authorization code is required"},{status:400});let r=process.env.GOOGLE_CLIENT_SECRET;if(!r)return console.error("GOOGLE_CLIENT_SECRET not configured"),s.Z.json({error:"Server configuration error"},{status:500});let o=e.headers.get("origin")||e.headers.get("host"),a=o?.includes("localhost")||o?.includes("127.0.0.1"),n=await fetch("https://oauth2.googleapis.com/token",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({client_id:"488875684334-urrslagsla2btuuri02acrunqum7d2bk.apps.googleusercontent.com",client_secret:r,code:t,grant_type:"authorization_code",redirect_uri:a?"http://localhost:3000/auth/callback":"https://cardscope-web.vercel.app/auth/callback"})});if(!n.ok){let e=await n.text();return console.error("Token exchange failed:",e),s.Z.json({error:"Token exchange failed"},{status:400})}let i=await n.json(),c=await fetch("https://www.googleapis.com/oauth2/v2/userinfo",{headers:{Authorization:`Bearer ${i.access_token}`}});if(!c.ok)return console.error("Failed to get user info"),s.Z.json({error:"Failed to get user info"},{status:400});let u=await c.json(),l={id:u.id,name:u.name,email:u.email,picture:u.picture};try{let e={name:u.name,email:u.email,provider:"google",providerId:u.id,image:u.picture||null};console.log("\uD83D\uDCDD Creating user in backend:",e.email);let t=await fetch("https://cardscope-app.onrender.com/api/user",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(t.ok)console.log("✅ User created/updated in backend:",u.email);else{let e=await t.text();console.error("⚠️ Failed to create user in backend:",e)}}catch(e){console.error("⚠️ Error creating user in backend:",e)}return s.Z.json({user:l})}catch(e){return console.error("OAuth token exchange error:",e),s.Z.json({error:"Authentication failed"},{status:500})}}let u=new a.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/auth/google/route",pathname:"/api/auth/google",filename:"route",bundlePath:"app/api/auth/google/route"},resolvedPagePath:"/Users/murari/WebstormProjects/cardscope-web/app/api/auth/google/route.ts",nextConfigOutput:"standalone",userland:o}),{requestAsyncStorage:l,staticGenerationAsyncStorage:d,serverHooks:p,headerHooks:h,staticGenerationBailout:g}=u,m="/api/auth/google/route";function f(){return(0,i.patchFetch)({serverHooks:p,staticGenerationAsyncStorage:d})}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),o=t.X(0,[638,206],()=>r(46217));module.exports=o})();