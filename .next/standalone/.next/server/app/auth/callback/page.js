(()=>{var e={};e.id=453,e.ids=[453],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},71017:e=>{"use strict";e.exports=require("path")},57310:e=>{"use strict";e.exports=require("url")},68829:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>n.a,__next_app__:()=>p,originalPathname:()=>u,pages:()=>d,routeModule:()=>m,tree:()=>c});var o=r(50482),s=r(69108),a=r(62563),n=r.n(a),i=r(68300),l={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>i[e]);r.d(t,l);let c=["",{children:["auth",{children:["callback",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,75714)),"/Users/murari/WebstormProjects/cardscope-web/app/auth/callback/page.tsx"]}]},{}]},{metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,57481))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,98982)),"/Users/murari/WebstormProjects/cardscope-web/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,69361,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,57481))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],d=["/Users/murari/WebstormProjects/cardscope-web/app/auth/callback/page.tsx"],u="/auth/callback/page",p={require:r,loadChunk:()=>Promise.resolve()},m=new o.AppPageRouteModule({definition:{kind:s.x.APP_PAGE,page:"/auth/callback/page",pathname:"/auth/callback",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},72991:(e,t,r)=>{Promise.resolve().then(r.bind(r,28419))},93148:(e,t,r)=>{Promise.resolve().then(r.bind(r,67296))},80575:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,2583,23)),Promise.resolve().then(r.t.bind(r,26840,23)),Promise.resolve().then(r.t.bind(r,38771,23)),Promise.resolve().then(r.t.bind(r,13225,23)),Promise.resolve().then(r.t.bind(r,9295,23)),Promise.resolve().then(r.t.bind(r,43982,23))},28419:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>i});var o=r(95344),s=r(3729),a=r(8428);function n(){let e=(0,a.useRouter)(),t=(0,a.useSearchParams)();(0,s.useEffect)(()=>{let e=t.get("code"),o=t.get("error");if(o){console.error("OAuth error:",o),r(`error=${encodeURIComponent(o)}`);return}e?n(e):r("no_code")},[t,e]);let r=(t,r)=>{if(/Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)){console.log("Detected mobile browser, attempting app redirect...");let e=`cardscope:///?status=${t}`;if(r&&"success"===t){let t=encodeURIComponent(JSON.stringify(r));e+=`&userData=${t}`,console.log("\uD83D\uDCF1 Including user data in redirect:",r),console.log("\uD83D\uDCF1 Full redirect URL:",e)}try{window.location.href=e,console.log("Attempted redirect via window.location.href")}catch(e){console.log("Method 1 failed:",e)}setTimeout(()=>{try{let t=document.createElement("iframe");t.style.display="none",t.src=e,document.body.appendChild(t),console.log("Attempted redirect via iframe"),setTimeout(()=>{document.body.removeChild(t)},1e3)}catch(e){console.log("Method 2 failed:",e)}},500),setTimeout(()=>{try{window.open(e,"_self"),console.log("Attempted redirect via window.open")}catch(e){console.log("Method 3 failed:",e)}},1e3),setTimeout(()=>{let e=document.getElementById("message");e&&(e.innerHTML=`
            <div style="text-align: center; padding: 20px; max-width: 400px; margin: 0 auto;">
              <h2 style="color: #28a745; margin-bottom: 20px;">✅ Authentication Complete!</h2>
              <p style="margin-bottom: 15px; font-size: 16px;">Your Google account has been successfully linked.</p>
              <p style="margin-bottom: 20px; color: #666;">Please return to the <strong>CardScope</strong> app to continue.</p>
              <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 20px;">
                <p style="margin: 0; font-size: 14px; color: #495057;">
                  <strong>How to return to the app:</strong><br>
                  • Swipe up from bottom (Android)<br>
                  • Use recent apps button<br>
                  • Tap the app icon on home screen
                </p>
              </div>
              <button onclick="window.close()" style="padding: 12px 24px; background: #007bff; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 16px; font-weight: 500;">
                Close Browser
              </button>
            </div>
          `)},2e3)}else e.push("/")},n=async e=>{try{let t=await fetch("/api/auth/google",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({code:e})});if(t.ok){let{user:e}=await t.json();if(console.log("✅ Got user from OAuth:",e),localStorage.setItem("cardscope_user",JSON.stringify(e)),console.log("✅ Stored user in localStorage"),window.dispatchEvent(new Event("authUpdated")),console.log("✅ Dispatched authUpdated event"),window.Capacitor){console.log("\uD83D\uDCF1 Capacitor detected, attempting postMessage to store user data");try{window.postMessage({type:"OAUTH_SUCCESS",user:e},"*")}catch(e){console.error("❌ Failed to send postMessage:",e)}}console.log("\uD83D\uDD04 Redirecting to app with user data"),r("success",e)}else throw Error("Token exchange failed")}catch(e){console.error("Token exchange error:",e),r("error=authentication_failed")}};return o.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,o.jsxs)("div",{className:"text-center",children:[o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),o.jsx("p",{className:"mt-4 text-gray-600",children:"Completing authentication..."}),o.jsx("div",{id:"message",className:"mt-4"})]})})}function i(){return o.jsx(s.Suspense,{fallback:o.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,o.jsxs)("div",{className:"text-center",children:[o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),o.jsx("p",{className:"mt-4 text-gray-600",children:"Loading..."})]})}),children:o.jsx(n,{})})}},67296:(e,t,r)=>{"use strict";r.r(t),r.d(t,{AuthProvider:()=>i,useAuth:()=>l});var o=r(95344),s=r(3729),a=r(77215);let n=(0,s.createContext)(void 0);function i({children:e}){let[t,r]=(0,s.useState)(null),[i,l]=(0,s.useState)(!0),c=()=>{try{if("undefined"==typeof localStorage){console.log("⚠️ localStorage not available"),r(null),l(!1);return}let e=localStorage.getItem("cardscope_user");if(e){let t=JSON.parse(e);r(t),console.log("✅ User found in localStorage:",t.email)}else r(null),console.log("❌ No user found in localStorage")}catch(e){console.error("Error checking auth:",e),r(null)}finally{l(!1)}};(0,s.useEffect)(()=>{if(c(),a.dV.isNativePlatform()){console.log("\uD83D\uDCF1 Setting up deep link listeners...");let e=e=>{console.log("\uD83D\uDCF1 Received appUrlOpen event:",e.detail?.url),e.detail?.url&&e.detail.url.includes("cardscope://")&&d(e.detail.url)};window.addEventListener("appUrlOpen",e);let t=e=>{console.log("\uD83D\uDCF1 Received deepLink event from native:",e.detail),d(e.detail)};window.addEventListener("deepLink",t);let r=()=>{let e=window.location.href;e&&e.includes("cardscope://")&&(console.log("\uD83D\uDCF1 Found cardscope:// in window.location:",e),d(e))};r();let o=setInterval(r,1e3);return()=>{window.removeEventListener("appUrlOpen",e),window.removeEventListener("deepLink",t),clearInterval(o)}}let e=e=>{if("cardscope_user"===e.key){if(e.newValue){let t=JSON.parse(e.newValue);r(t),console.log("✅ User updated from storage:",t.email)}else r(null),console.log("❌ User removed from storage")}};window.addEventListener("storage",e);let t=()=>{c()};return window.addEventListener("authUpdated",t),()=>{window.removeEventListener("storage",e),window.removeEventListener("authUpdated",t)}},[]);let d=e=>{try{console.log("\uD83D\uDD17 Processing deep link URL:",e);let t=new URL(e),o=t.searchParams.get("status"),s=t.searchParams.get("userData");if(console.log("\uD83D\uDCF1 Deep link status:",o),console.log("\uD83D\uDCF1 Deep link userData:",s),"success"===o&&s){let e=JSON.parse(decodeURIComponent(s));console.log("\uD83D\uDCF1 Parsed user data from deep link:",e),localStorage.setItem("cardscope_user",JSON.stringify(e)),r(e),window.dispatchEvent(new Event("authUpdated")),console.log("✅ User data stored from deep link")}}catch(e){console.error("Error processing deep link:",e)}};return o.jsx(n.Provider,{value:{user:t,isLoading:i,signOut:()=>{localStorage.removeItem("cardscope_user"),r(null),console.log("✅ User signed out")}},children:e})}function l(){let e=(0,s.useContext)(n);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},75714:(e,t,r)=>{"use strict";r.r(t),r.d(t,{$$typeof:()=>a,__esModule:()=>s,default:()=>n});let o=(0,r(86843).createProxy)(String.raw`/Users/murari/WebstormProjects/cardscope-web/app/auth/callback/page.tsx`),{__esModule:s,$$typeof:a}=o,n=o.default},98982:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>m,metadata:()=>u,viewport:()=>p});var o=r(25036),s=r(20569),a=r.n(s);r(67272);var n=r(86843);let i=(0,n.createProxy)(String.raw`/Users/murari/WebstormProjects/cardscope-web/contexts/AuthContext.tsx`),{__esModule:l,$$typeof:c}=i;i.default;let d=(0,n.createProxy)(String.raw`/Users/murari/WebstormProjects/cardscope-web/contexts/AuthContext.tsx#AuthProvider`);(0,n.createProxy)(String.raw`/Users/murari/WebstormProjects/cardscope-web/contexts/AuthContext.tsx#useAuth`);let u={title:"CardScope",description:"CardScope — your personalized credit card rewards advisor"},p={width:"device-width",initialScale:1,maximumScale:1,userScalable:!1,viewportFit:"cover"};function m({children:e}){return o.jsx("html",{lang:"en",className:a().variable,children:o.jsx("body",{className:"font-sans bg-gray-50 text-gray-900 antialiased",children:o.jsx(d,{children:e})})})}},57481:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});var o=r(70337);let s=e=>[{type:"image/x-icon",sizes:"16x16",url:(0,o.fillMetadataSegment)(".",e.params,"favicon.ico")+""}]},67272:()=>{}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),o=t.X(0,[638,650,404],()=>r(68829));module.exports=o})();