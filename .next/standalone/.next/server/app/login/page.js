(()=>{var e={};e.id=626,e.ids=[626],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},39491:e=>{"use strict";e.exports=require("assert")},6113:e=>{"use strict";e.exports=require("crypto")},82361:e=>{"use strict";e.exports=require("events")},57147:e=>{"use strict";e.exports=require("fs")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},71017:e=>{"use strict";e.exports=require("path")},12781:e=>{"use strict";e.exports=require("stream")},76224:e=>{"use strict";e.exports=require("tty")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},59796:e=>{"use strict";e.exports=require("zlib")},87529:()=>{},84868:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>n.a,__next_app__:()=>p,originalPathname:()=>d,pages:()=>u,routeModule:()=>m,tree:()=>c});var s=r(50482),o=r(69108),a=r(62563),n=r.n(a),i=r(68300),l={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>i[e]);r.d(t,l);let c=["",{children:["login",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,43015)),"/Users/murari/WebstormProjects/cardscope-web/app/login/page.tsx"]}]},{metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,57481))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,98982)),"/Users/murari/WebstormProjects/cardscope-web/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,69361,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,57481))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],u=["/Users/murari/WebstormProjects/cardscope-web/app/login/page.tsx"],d="/login/page",p={require:r,loadChunk:()=>Promise.resolve()},m=new s.AppPageRouteModule({definition:{kind:o.x.APP_PAGE,page:"/login/page",pathname:"/login",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},42975:(e,t,r)=>{Promise.resolve().then(r.bind(r,89928))},93148:(e,t,r)=>{Promise.resolve().then(r.bind(r,67296))},80575:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,2583,23)),Promise.resolve().then(r.t.bind(r,26840,23)),Promise.resolve().then(r.t.bind(r,38771,23)),Promise.resolve().then(r.t.bind(r,13225,23)),Promise.resolve().then(r.t.bind(r,9295,23)),Promise.resolve().then(r.t.bind(r,43982,23))},89928:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>u,dynamic:()=>c});var s=r(95344),o=r(3729),a=r(8428),n=r(67296),i=r(18117),l=r(77215);let c="force-dynamic";function u(){let e=(0,a.useRouter)(),{user:t,isLoading:r}=(0,n.useAuth)(),c=(0,o.useRef)(!1),[u,d]=(0,o.useState)(""),[p,m]=(0,o.useState)(""),[g,h]=(0,o.useState)("");(0,o.useEffect)(()=>{!t||r||c.current||(c.current=!0,console.log("✅ Login success → redirecting to /"),e.replace("/"))},[t,r,e]);let x=async e=>{if(e.preventDefault(),h(""),!u){h("Please enter your email");return}try{let e=await i.Z.post("/api/auth/login",{email:u,password:p}),t={id:u,name:e.data?.name||u.split("@")[0],email:u,picture:null};localStorage.setItem("cardscope_user",JSON.stringify(t)),console.log("✅ Stored user in localStorage:",t),window.dispatchEvent(new Event("authUpdated")),await new Promise(e=>setTimeout(e,200)),window.dispatchEvent(new Event("authUpdated")),console.log("✅ Manual login successful:",u),window.location.href="/"}catch(e){console.error("❌ Login failed:",e),h("Invalid email or password. Please try again.")}},v=async()=>{try{console.log("\uD83D\uDD0D Starting Google sign-in..."),console.log("\uD83D\uDCF1 Is native platform:",l.dV.isNativePlatform());let e="localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname,t=`https://accounts.google.com/o/oauth2/v2/auth?client_id=488875684334-urrslagsla2btuuri02acrunqum7d2bk.apps.googleusercontent.com&redirect_uri=${encodeURIComponent(e?"http://localhost:3000/auth/callback":"https://cardscope-web.vercel.app/auth/callback")}&response_type=code&scope=openid%20email%20profile&access_type=offline`;console.log("\uD83D\uDCF1 OAuth URL:",t),l.dV.isNativePlatform()&&console.log("\uD83D\uDCF1 Navigating WebView to OAuth URL"),window.location.href=t}catch(e){console.error("❌ Google sign-in failed:",e),h("Google sign-in failed. Please try again.")}},f=async()=>{try{console.log("\uD83C\uDF4E Starting Apple sign-in...");let e=await fetch("/api/auth/providers");if(!(await e.json()).apple){h("Apple Sign-In is not configured. Please contact support or use another login method."),console.error("❌ Apple provider not available");return}window.location.href="/api/auth/signin/apple"}catch(e){console.error("❌ Apple sign-in failed:",e),h("Apple sign-in failed. Please try again.")}};return((0,o.useEffect)(()=>{"apple"===new URLSearchParams(window.location.search).get("error")&&fetch("/api/auth/providers").then(e=>e.json()).then(e=>{e.apple?h("Apple Sign-In failed. Please check that the Return URL 'https://cardscope-web.vercel.app/api/auth/callback/apple' is configured in Apple Developer Console."):h("Apple Sign-In is not configured. Please add environment variables to Vercel or use another login method.")}).catch(()=>{h("Apple Sign-In failed. Please check Apple Developer Console configuration.")})},[]),r)?(console.log("\uD83D\uDD04 Auth status: loading"),(0,s.jsxs)("div",{className:"min-h-screen flex flex-col items-center justify-center space-y-3 text-gray-500",children:[s.jsx("img",{src:"/spinner.svg",alt:"Loading",className:"w-8 h-8 animate-spin"}),s.jsx("p",{children:"Checking your session..."})]})):t?s.jsx("div",{className:"min-h-screen flex items-center justify-center text-gray-500",children:"Redirecting to your dashboard..."}):s.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 px-4",children:(0,s.jsxs)("div",{className:"max-w-md w-full bg-white shadow-md rounded-lg p-6 sm:p-8 space-y-6",children:[s.jsx("h1",{className:"text-center text-xl font-bold",children:"\uD83D\uDD11 Login"}),g&&s.jsx("p",{className:"text-red-600 text-sm text-center",children:g}),(0,s.jsxs)("form",{onSubmit:x,className:"space-y-4",children:[(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),s.jsx("input",{type:"email",className:"w-full border p-3 rounded-lg text-sm focus:ring-2 focus:ring-blue-500",placeholder:"you@example.com",value:u,onChange:e=>d(e.target.value)})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),s.jsx("input",{type:"password",className:"w-full border p-3 rounded-lg text-sm focus:ring-2 focus:ring-blue-500",placeholder:"••••••••",value:p,onChange:e=>m(e.target.value)}),s.jsx("div",{className:"text-right mt-1",children:s.jsx("button",{type:"button",onClick:()=>e.push("/reset"),className:"text-sm text-blue-600 hover:underline",children:"Forgot password?"})})]}),s.jsx("button",{type:"submit",className:"btn btn-primary w-full",children:"Login"})]}),(0,s.jsxs)("div",{className:"flex items-center my-4",children:[s.jsx("div",{className:"flex-grow border-t border-gray-200"}),s.jsx("span",{className:"mx-2 text-gray-400 text-sm",children:"or"}),s.jsx("div",{className:"flex-grow border-t border-gray-200"})]}),(0,s.jsxs)("button",{onClick:v,className:"flex items-center justify-center w-full border border-gray-300 rounded-lg py-2 hover:bg-gray-50 transition",children:[s.jsx("img",{src:"https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg",alt:"Google",className:"h-5 w-5 mr-2"}),"Continue with Google"]}),(0,s.jsxs)("button",{onClick:f,className:"flex items-center justify-center w-full bg-black text-white rounded-lg py-2 hover:bg-gray-800 transition",children:[s.jsx("svg",{className:"h-5 w-5 mr-2",viewBox:"0 0 24 24",fill:"currentColor",children:s.jsx("path",{d:"M17.05 20.28c-.98.95-2.05.88-3.08.4-1.09-.5-2.08-.48-3.24 0-1.44.62-2.2.44-3.06-.4C4.79 15.25 3.8 10.45 6.05 7.96c1.15-1.23 2.5-1.93 4.05-1.93 1.18 0 2.06.4 3.08.88.78.38 1.48.58 1.98.58.44 0 1.15-.2 1.98-.58 1.02-.48 1.9-.88 3.08-.88 1.58 0 2.93.73 4.08 1.96-3.12 3.53-2.61 8.5 1.08 11.32-1.1 1.01-2.2 1.4-3.18 1.4zm-2.04-17.3c.15 1.15-.34 2.3-1.05 3.04-.73.76-1.9 1.25-3.04 1.15-.15-1.15.35-2.3 1.06-3.04.74-.76 1.91-1.24 3.03-1.15z"})}),"Continue with Apple"]}),s.jsx("div",{className:"text-center mt-4",children:(0,s.jsxs)("p",{className:"text-sm",children:["New user?"," ",s.jsx("button",{onClick:()=>e.push("/signup"),className:"text-blue-600 hover:underline",children:"Sign up here"})]})})]})})}},67296:(e,t,r)=>{"use strict";r.r(t),r.d(t,{AuthProvider:()=>i,useAuth:()=>l});var s=r(95344),o=r(3729),a=r(77215);let n=(0,o.createContext)(void 0);function i({children:e}){let[t,r]=(0,o.useState)(null),[i,l]=(0,o.useState)(!0),c=()=>{try{if("undefined"==typeof localStorage){console.log("⚠️ localStorage not available"),r(null),l(!1);return}let e=localStorage.getItem("cardscope_user");if(e){let t=JSON.parse(e);r(t),console.log("✅ User found in localStorage:",t.email)}else r(null),console.log("❌ No user found in localStorage")}catch(e){console.error("Error checking auth:",e),r(null)}finally{l(!1)}};(0,o.useEffect)(()=>{if(c(),a.dV.isNativePlatform()){console.log("\uD83D\uDCF1 Setting up deep link listeners...");let e=e=>{console.log("\uD83D\uDCF1 Received appUrlOpen event:",e.detail?.url),e.detail?.url&&e.detail.url.includes("cardscope://")&&u(e.detail.url)};window.addEventListener("appUrlOpen",e);let t=e=>{console.log("\uD83D\uDCF1 Received deepLink event from native:",e.detail),u(e.detail)};window.addEventListener("deepLink",t);let r=()=>{let e=window.location.href;e&&e.includes("cardscope://")&&(console.log("\uD83D\uDCF1 Found cardscope:// in window.location:",e),u(e))};r();let s=setInterval(r,1e3);return()=>{window.removeEventListener("appUrlOpen",e),window.removeEventListener("deepLink",t),clearInterval(s)}}let e=e=>{if("cardscope_user"===e.key){if(e.newValue){let t=JSON.parse(e.newValue);r(t),console.log("✅ User updated from storage:",t.email)}else r(null),console.log("❌ User removed from storage")}};window.addEventListener("storage",e);let t=()=>{c()};return window.addEventListener("authUpdated",t),()=>{window.removeEventListener("storage",e),window.removeEventListener("authUpdated",t)}},[]);let u=e=>{try{console.log("\uD83D\uDD17 Processing deep link URL:",e);let t=new URL(e),s=t.searchParams.get("status"),o=t.searchParams.get("userData");if(console.log("\uD83D\uDCF1 Deep link status:",s),console.log("\uD83D\uDCF1 Deep link userData:",o),"success"===s&&o){let e=JSON.parse(decodeURIComponent(o));console.log("\uD83D\uDCF1 Parsed user data from deep link:",e),localStorage.setItem("cardscope_user",JSON.stringify(e)),r(e),window.dispatchEvent(new Event("authUpdated")),console.log("✅ User data stored from deep link")}}catch(e){console.error("Error processing deep link:",e)}};return s.jsx(n.Provider,{value:{user:t,isLoading:i,signOut:()=>{localStorage.removeItem("cardscope_user"),r(null),console.log("✅ User signed out")}},children:e})}function l(){let e=(0,o.useContext)(n);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},18117:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});var s=r(11934);let o="https://cardscope-app.onrender.com";console.log("API Base URL →",o);let a=s.Z.create({baseURL:o,headers:{"Content-Type":"application/json"}});a.interceptors.response.use(e=>e,e=>(console.error("API Error:",e.response?.data||e.message),Promise.reject(e)));let n=a},98982:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>m,metadata:()=>d,viewport:()=>p});var s=r(25036),o=r(20569),a=r.n(o);r(67272);var n=r(86843);let i=(0,n.createProxy)(String.raw`/Users/murari/WebstormProjects/cardscope-web/contexts/AuthContext.tsx`),{__esModule:l,$$typeof:c}=i;i.default;let u=(0,n.createProxy)(String.raw`/Users/murari/WebstormProjects/cardscope-web/contexts/AuthContext.tsx#AuthProvider`);(0,n.createProxy)(String.raw`/Users/murari/WebstormProjects/cardscope-web/contexts/AuthContext.tsx#useAuth`);let d={title:"CardScope",description:"CardScope — your personalized credit card rewards advisor"},p={width:"device-width",initialScale:1,maximumScale:1,userScalable:!1,viewportFit:"cover"};function m({children:e}){return s.jsx("html",{lang:"en",className:a().variable,children:s.jsx("body",{className:"font-sans bg-gray-50 text-gray-900 antialiased",children:s.jsx(u,{children:e})})})}},43015:(e,t,r)=>{"use strict";r.r(t),r.d(t,{$$typeof:()=>n,__esModule:()=>a,default:()=>c,dynamic:()=>l});var s=r(86843);let o=(0,s.createProxy)(String.raw`/Users/murari/WebstormProjects/cardscope-web/app/login/page.tsx`),{__esModule:a,$$typeof:n}=o,i=o.default,l=(0,s.createProxy)(String.raw`/Users/murari/WebstormProjects/cardscope-web/app/login/page.tsx#dynamic`),c=i},57481:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>o});var s=r(70337);let o=e=>[{type:"image/x-icon",sizes:"16x16",url:(0,s.fillMetadataSegment)(".",e.params,"favicon.ico")+""}]},67272:()=>{}};var t=require("../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[638,650,404,934],()=>r(84868));module.exports=s})();